<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A library for tracking references to shared resources such as memory.">
    <meta name="author" content="Sourcery Institute" >
    <link rel="icon" href="./favicon.png">

    <title>  </title>

    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/pygments.css" rel="stylesheet">
    <link href="./css/font-awesome.min.css" rel="stylesheet">
    <link href="./css/local.css" rel="stylesheet">
    <link  href="./tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="./js/jquery-2.1.3.min.js"></script>
    <script src="./js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="./index.html"> </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="./lists/files.html">Source Files</a></li>
            <li><a href="./lists/modules.html">Modules</a></li>
            <li><a href="./lists/procedures.html">Procedures</a></li>
            <li><a href="./lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="./lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="./lists/types.html">Derived Types</a></li>
          </ul>
        <form action="./search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
        <p>A library for tracking references to shared resources such as memory.</p>
	<p> Find us on&hellip;</p>
        <p>
          <a class="btn btn-lg btn-primary" href="https://github.com/sourceryinstitute/dag
https://github.com/sourceryinstitute/reference-counter" role="button">GitHub</a>
          <a class="btn btn-lg btn-danger" style="float:right" href="https://github.com/sourceryinstitute/reference-counter/releases" role="button">Download the Source</a>
        </p>
      </div>

      <div class="row" id='text'>
        <div class="col-md-8">
          <h1></h1>
          <h1 id="reference-counter">Reference Counter</h1>
<div class="codehilite"><pre><span></span>__________        _____                                          
\______   \ _____/ ____\___________   ____   ____   ____  ____   
 |       _// __ \   __\/ __ \_  __ \_/ __ \ /    \_/ ___\/ __ \  
 |    |   \  ___/|  | \  ___/|  | \/\  ___/|   |  \  \__\  ___/  
 |____|_  /\___&gt; |__|  \___&gt; |__|    \___&gt; |___|  /\____&gt;\___&gt;
                                                \/            
 _________                      __
 \_   ___ \  ____  __ __  _____/  |_  ___________
 /    \  \/ /  _ \|  |  \/    \   __\/ __ \_  __ \
 \     \___(  &lt;_&gt; )  |  /   |  \  | \  ___/|  | \/
  \_______/ \____/|____/|___|  /__|  \___&gt;  __|
                             \/            
</pre></div>

<h2 id="overview">Overview</h2>
<p>Reference Counter offers semi-automatic counting of references to program resources
such as memory.  A user accesses the provided reference-counting capability simply
by defining a non-abstract derived type that </p>
<ol>
<li>Extends Reference Counter's <code>ref_reference_t</code> type and</li>
<li>Implements the so-inherited <code>free</code> deferred binding.</li>
</ol>
<p>Because the reference-counting algorithm involves copying references in certain
circumstances, the user type that extends s<code>ref_reference_t</code> should be a lightweight
proxy for a more stateful entity stored elsewhere.  For example, the user type might 
contain a Fortran <code>pointer</code> associated with some other object or it might contain
a "shadow" object that serves as an identity tag for a larger object allocated 
(and later freed) in C or C++ at the direction of the user's <code>free</code> procedure.</p>
<p>For more background on the design philosophy and the internal mechanics of Reference
Counter, see Rouson et al. (see <a>1</a>, <a>2</a>, <a>3</a>).  This repository's code
originated from refactoring the code in those publications to use more descriptive
and more general nomenclature and more up-to-date coding conventions.  For example,
this repository separates interface bodies into modules and procedure definitions
into submodules.</p>
<p>As compared to the original code, this repository also adds
1. A <a href="https://github.com/fortran-lang/fpm">Fortran Package Manager</a> build system,
2. Tests based on the <a href="https://gitlab.com/everythingfunctional/vegetables">Vegetables</a> unit-testing software,
3. Documentation generated by [<code>ford</code>] and deployed to the web via GitHub Actions, and
4. Quality control via continuous integration testing using GitHub Actions.</p>
<h2 id="documentation">Documentation</h2>
<p>See <a href="https://sourceryinstitute.github.io/reference-counter">Reference Counter's GitHub Pages site</a> for HTML documentation generated with [<code>ford</code>].</p>
<p>See the <a href="./doc">doc/</a> subdirectory for a <a href="https://plantuml.com">PlantUML</a> script that generates the Unified Modeling Langauge (UML) class diagram below of the three derived types in reference-counter.  </p>
<p><img alt="class_diagram" src="https://user-images.githubusercontent.com/13108868/165135689-4d2e85fe-6946-472f-a154-aaabebf6d4f5.png"></p>
<p>The above image was created with the PlantuML package in the <a href="https://atom.io">Atom</a> editor.</p>
<h2 id="compiler-status">Compiler Status</h2>
<p>Correct execution of the Reference Counter library code requires comprehensive
compiler support for Fortran's type finalization semantics.  The unit test suite
includes compiler standard-conformance tests.  We have attempted to include at least
one example of each scenario in which the Fortran 2018 standard requires compilers
to finalize objects.  The table below summarizes the observed compiler behaviors:</p>
<table>
<thead>
<tr>
<th align="left"><em>Compiler</em></th>
<th align="center"><em>Test failures</em></th>
<th align="left"><em>Version tested</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">NAG</td>
<td align="center">1</td>
<td align="left"><code>nagfor</code> 7.1</td>
</tr>
<tr>
<td align="left">GCC</td>
<td align="center">4</td>
<td align="left"><code>gfortran</code> 11.3.0, 12.1.0</td>
</tr>
<tr>
<td align="left">Intel</td>
<td align="center">2</td>
<td align="left"><code>ifort</code> 2021.5.0 Build 20211109_000000</td>
</tr>
<tr>
<td align="left">NVIDIA</td>
<td align="center">Fails to build (ICE)</td>
<td align="left"><code>nvfortran</code> 2022.2</td>
</tr>
<tr>
<td align="left">AMD</td>
<td align="center">Fails to build (ICE)</td>
<td align="left"><code>flang</code> 13.0.0 (AOCC_3.2.0-Build#128 2021_11_12)</td>
</tr>
</tbody>
</table>
<h2 id="downloading-building-and-testing">Downloading, Building, and Testing</h2>
<p>On Linux, macOS, or Windows Subsystem for Linux, download, build, and test with
the following shell commands:</p>
<div class="codehilite"><pre><span></span>git clone git@github.com:sourceryinstitute/reference-counter
cd reference-counter
</pre></div>

<p>followed by one of the commands below depending on your compiler choice.</p>
<h3 id="gcc-gfortran">GCC (<code>gfortran</code>)</h3>
<div class="codehilite"><pre><span></span>fpm test
</pre></div>

<h3 id="numerical-algorithms-group-nagfor">Numerical Algorithms Group (<code>nagfor</code>)</h3>
<div class="codehilite"><pre><span></span>fpm test --compiler nagfor --flag -fpp
</pre></div>

<h3 id="intel-ifort">Intel (<code>ifort</code>)</h3>
<div class="codehilite"><pre><span></span>fpm test --compiler ifort --flag -coarray=shared
</pre></div>

<h3 id="nvidia-nvfortran">NVIDIA (<code>nvfortran</code>)</h3>
<div class="codehilite"><pre><span></span>fpm test --compiler nvfortran --flag -Mpreprocess
</pre></div>

<h3 id="amd-flang">AMD (<code>flang</code>)</h3>
<div class="codehilite"><pre><span></span>fpm test --compiler flang --flag -cpp
</pre></div>
        </div>
        <div class="col-md-4">
	  <div class="well">
          <h2>Developer Info</h2>
          <h4>Sourcery Institute</h4>
          
            <div class="text-center"><div class="btn-group" role="group">
              <a class="btn btn-lg btn-primary" href="https://github.com/sourceryinstitute"><i class="fa fa-github fa-lg"></i></a>
            </div></div>
       </div>
       </div>
      </div>
      <div class="row">
        <div class="col-xs-6 col-sm-3">
              <h3>Source Files</h3>
              <ul>                    <li><a href='./sourcefile/ref_counter_m.f90.html'>ref_counter_m.f90</a></li>
                    <li><a href='./sourcefile/ref_counter_s.f90.html'>ref_counter_s.f90</a></li>
                    <li><a href='./sourcefile/ref_reference_m.f90.html'>ref_reference_m.f90</a></li>
                    <li><a href='./sourcefile/ref_reference_s.f90.html'>ref_reference_s.f90</a></li>
                    <li><a href='./sourcefile/ref_resource_m.f90.html'>ref_resource_m.f90</a></li>
                    <li><a href='./sourcefile/reference_counter_m.f90.html'>reference_counter_m.f90</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Modules</h3>
              <ul>                    <li><a href='./module/ref_counter_m.html'>ref_counter_m</a></li>
                    <li><a href='./module/ref_reference_m.html'>ref_reference_m</a></li>
                    <li><a href='./module/ref_resource_m.html'>ref_resource_m</a></li>
                    <li><a href='./module/reference_counter_m.html'>reference_counter_m</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Procedures</h3>
              <ul>                    <li><a href='./interface/assign_ref_counter.html'>assign_ref_counter</a></li>
                    <li><a href='./proc/finalize.html'>finalize</a></li>
                    <li><a href='./interface/grab.html'>grab</a></li>
                    <li><a href='./interface/ref_counter_t.html'>ref_counter_t</a></li>
                    <li><a href='./interface/release.html'>release</a></li>
                    <li><a href='./interface/release_handle.html'>release_handle</a></li>
                    <li><a href='./interface/start_ref_counter.html'>start_ref_counter</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Derived Types</h3>
              <ul>                    <li><a href='./type/ref_counter_t.html'>ref_counter_t</a></li>
                    <li><a href='./type/ref_reference_t.html'>ref_reference_t</a></li>
                    <li><a href='./type/ref_resource_t.html'>ref_resource_t</a></li>
</ul>
          </div>
      </div>
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p> was developed by Sourcery Institute<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-05-10 05:21            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="./js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="./js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="./tipuesearch/tipuesearch_content.js"></script>
    <script src="./tipuesearch/tipuesearch_set.js"></script>
    <script src="./tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>